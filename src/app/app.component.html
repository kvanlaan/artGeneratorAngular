<div fxLayout="column" fxFlexFill>
  <div fxLayout="row" fxLayoutWrap>
    <div fxFlex="40" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" fxFlexOffset="5" fxLayoutAlign="start center">
      <div class="material-text" fxFlex fxLayoutAlign="start center">Art Generator</div>
      <div fxFlex class="material-text" style="font-size: 14px !important" fxShow="true" fxShow.md="false" fxShow.sm="false" fxShow.xs="false"
         fxLayoutAlign="end center">Each piece is algorithmically unique.</div>
    </div>

    <div fxFlex>
      <div fxFlex fxFlexOffset="7" fxShow="true" fxLayoutGap="5px" fxShow.md="false" fxShow.sm="false" fxShow.xs="false" fxLayoutAlign="start center">
        <button [disabled]="!renderDone" (click)="getRandomArt(true)" class="float-left inline" mat-stroked-button>
          Get New Art</button>
        <a href="#" target="_blank" class="float-left inline" #downloadLink (click)="download(downloadLink)" download="art.jpg">
          <button [disabled]="!renderDone" mat-stroked-button>
            Save this art
          </button>
        </a>
      </div>
      <div fxFlex fxShow="true" fxLayoutAlign="end center">
        <button [fxShow]="!login" (click)="openLoginModal()" mat-stroked-button>
          <span > Sign In </span>
        </button>
        <span *ngIf="login"  fxLayoutAlign="horizontal center" fxLayoutGap="5px">
          <span>{{email}}</span>
          <button fxFlex="5" (click)="signOut()" fxShow.md="false" fxShow.sm="false" fxShow.xs="false" mat-stroked-button>
            <span> Sign Out </span>
          </button>
        </span>
      </div>
      <div fxFlex="6"></div>
    </div>
  </div>
  <div fxFlexOffset="2" fxLayout="row" fxShow="false" fxShow.md="true" fxShow.sm="true" fxShow.xs="true" fxLayoutWrap>
    <div fxFlex fxFlexOffset="5" fxLayoutAlign="start center"> Each piece is algorithmically unique.</div>
    <div fxFlex="20" fxLayoutAlign="end center">


      <button *ngIf="login" fxFlex="5" (click)="signOut()" mat-stroked-button>
        <span> Sign Out </span>
      </button>

    </div>
  </div>
  <div fxFlexOffset="0" fxLayout="row" fxShow="false" fxShow.md="true" fxShow.sm="true" fxShow.xs="true" fxLayoutWrap>
    <div fxFlexOffset="4" fxFlex="60" fxLayoutAlign="start center" fxLayoutGap="5">
      <button [disabled]="!renderDone" (click)="getRandomArt(true)" class="float-left inline" mat-stroked-button>
        Get New Art</button>
      <a href="#" target="_blank" class="inline" #downloadLinkTwo (click)="download(downloadLinkTwo)" download="art.jpg">

        <button [disabled]="!renderDone" mat-stroked-button>
          Save this art
        </button>
      </a>
    </div>
    <div fxFlex="40" fxLayoutAlign="end center">

    </div>
  </div>

  <div fxFlexOffset="0" fxLayout="row" fxShow="false" fxShow.md="true" fxShow.sm="true" fxShow.xs="true" fxLayoutWrap fxLayoutGap="5px" fxLayoutAlign="start center">
    <div fxFlexOffset="4" fxLayoutAlign="start center">
      <span (click)="filterFavorites()" class="hover-red">
        <i class="material-icons">
          filter_list
        </i>

        <i [fxShow]="showFavorites" class="material-icons">
          favorite
        </i>
        <i [fxShow]="!showFavorites" class="material-icons">
          favorite_border
        </i>
      </span>
    </div>

      
      <mat-slide-toggle [@.disabled]="true" (change)="toggleImages()"></mat-slide-toggle>
      <span *ngIf="ready" fxLayout="row" fxLayoutAlign="start center">
        <span *ngFor="let customImage of customImages; let i = index" [ngStyle]="{'background-image': 'url(' + this.customImages[i]?.src + ')'}"
          class="tile">
          <input #fileInput class="file-input" type="file" multiple (change)="uploadCustomImage(i, $event)">
          <span class="upload hover" fxLayoutAlign="center end">
            <i [fxShow]="customImage.ready" class="material-icons heart margin-top-auto bottom-0">
              arrow_upward
            </i>
          </span>
          <span [fxShow]="!customImage.ready" class="upload" fxLayoutAlign="center end">
            <div class="margin-auto loader small"></div>
          </span>
          <span [fxShow]="customImage.fileTooBig" class="upload warning" fxLayoutAlign="end center"
            fxLayout="column">
            <i class="material-icons heart margin-top-auto bottom-0">
              warning
            </i>
          </span>
        </span>
      </span>
  </div>

  <div class="min-height-450" fxLayout="row" fxFlex fxFlexOffset.md="5" fxFlexOffset.sm="5" fxFlexOffset.xs="5" fxLayout.md="column" fxLayout.sm="column"
    fxLayout.xs="column">
    <div class="relative overflow-scroll" fxFlex="40" fxFlexOffset.xl="5" fxFlexOffset.md="5" fxFlexOffset.lg="5" fxFlexOffset.md="0" fxFlexOffset.sm="0" fxFlex.md="25"
      fxFlex.sm="20" fxFlex.xs="20">
      <mat-grid-list *ngIf="!showFavorites" class="canvas-height" cols="5" rows="5" gutterSize="5px">
        <div [fxShow]="!imagePopulationDone" #loaderCanvas class="absolute margin-auto loader">
        </div>
        <mat-grid-tile fxLayout="row" *ngFor="let savedImg of savedImageArr; let i = index;">
          <img class="on-hover-outline height-100 width-100 float-left" [ngClass]="{'selected': i === currImageIndex}" (click)="renderImage(i)" [(src)]="savedImageArr[i]['src']"
          />
          <span class="img-action-buttons" fxLayout="row">
            <span [fxShow.lg]="true" [fxShow.md]="true" [fxShow.sm]="false" [fxShow.xs]="false">
              <i (click)="openDeleteDialog(savedImg, i)" class="material-icons on-hover-trash heart">
                delete
              </i>
              <i (click)="saveToFavorites(savedImg, i)" class="material-icons on-hover-trash heart" [ngClass]="{
                  'show': savedImg.favorite 
                }">
                favorite
              </i>
            </span>

            <span [fxShow.xl]="false" [fxShow.lg]="false" [fxShow.md]="false" [fxShow.sm]="true" [fxShow.xs]="true">
              <i (click)="openDeleteDialog(savedImg, i)" class="material-icons heart">
                delete_outline
              </i>
              <i (click)="saveToFavorites(savedImg, i)" class="material-icons heart">
                {{ savedImg.favorite ? 'favorite' : 'favorite_border'}}
              </i>
            </span>
          </span>
        </mat-grid-tile>

      </mat-grid-list>

      <mat-grid-list  *ngIf="showFavorites" class="canvas-height" cols="5" rows="5" gutterSize="5px">
        <mat-grid-tile *ngFor="let savedImg of favoritesArr; let i = index;">

          <img class="on-hover-outline height-100 width-100 float-left" [ngClass]="{
                  'selected': i === currImageIndex
                }" (click)="renderImage(i)"  [(src)]="savedImg.src" />
          <span class="img-action-buttons" fxLayout="row">

            <span [fxShow.lg]="true" [fxShow.md]="true" [fxShow.sm]="false" [fxShow.xs]="false">

              <i (click)="openDeleteDialog(savedImg, i)" class="material-icons on-hover-trash">
                delete
              </i>
              <i (click)="saveToFavoritesFromFavorite(savedImg, i)" class="material-icons on-hover-trash heart" [ngClass]="{
                          'show': savedImg.favorite 
                        }">
                favorite
              </i>
            </span>


            <span [fxShow.lg]="false" [fxShow.md]="false" [fxShow.sm]="true" [fxShow.xs]="true">
              <i (click)="openDeleteDialog(savedImg, i)" class="material-icons">
                delete_outline
              </i>
              <i (click)="saveToFavorites(savedImg, i)" class="material-icons heart">
                {{ savedImg.favorite ? 'favorite' : 'favorite_border'}}
              </i>
            </span>
          </span>
        </mat-grid-tile>
      </mat-grid-list>
    </div>
    <div fxFlex>
      <span class="text-align-left" fxFlex="7" fxShow.md="false" fxShow.sm="false" fxShow.xs="false" [fxShow]="ready" fxLayout="column"
        fxLayoutAlign="start center" fxLayoutGap="9px">

        <span class="hover-red material-text float-left text-align-center" fxShow.lg="true" fxShow.md="false" fxShow.sm="false" fxShow.xs="false" 
          (click)="filterFavorites()"><i class="material-icons">
            filter_list
          </i>

          <i [fxShow]="showFavorites" class="material-icons">
            favorite
          </i>
          <i [fxShow]="!showFavorites" class="material-icons">
            favorite_border
          </i>
        </span>
        <mat-slide-toggle [@.disabled]="true" (change)="toggleImages()"></mat-slide-toggle>
        <span *ngIf="ready" fxLayout="column" fxLayoutAlign="start center">
          <span *ngFor="let customImage of customImages; let i = index" [ngStyle]="{'background-image': 'url(' + this.customImages[i]?.src + ')'}"
            class="tile">
            <input #fileInput class="file-input" type="file" multiple (change)="uploadCustomImage(i, $event)">
            <span class="upload hover" fxLayoutAlign="center end">
              <i [fxShow]="customImage.ready" class="material-icons heart margin-top-auto bottom-0">
                arrow_upward
              </i>
            </span>
            <span [fxShow]="!customImage.ready" class="upload" fxLayoutAlign="center end">
              <div class="margin-auto loader small"></div>
            </span>
            <span [fxShow]="customImage.fileTooBig" class="upload warning" fxLayoutAlign="end center"
              fxLayout="column">
              <i class="material-icons heart margin-top-auto bottom-0">
                warning
              </i>
            </span>
          </span>
        </span>
      </span>
      <generator [imagesActive]="imagesActive" [customImages]="customImages" [savedImageArr]="savedImageArr" (saveImageFirebase)="saveImageFirebase($event)" (renderDoneEmit)="setRenderDone(true)"></generator>
    </div>
  </div>
  <div fxLayout="row" fxShow="true" fxShow.md="false" fxShow.sm="false" fxShow.xs="false" fxLayoutAlign="start start">
    <span class="material-text" fxFlexOffset="5" style="font-size: 14px !important">art and code by <a href="https://github.com/kvanlaan"
        class="name" target="_blank"> Katrina Van Laan</a></span>
  </div>
</div>
<div [fxShow]="!ready" class="absolute margin-auto loader">
</div>